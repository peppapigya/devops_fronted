# 菜单初始化说明

## 📋 概述

为了确保菜单管理系统正常运行，您需要先在数据库中插入默认的菜单数据。这里提供了两种方式来初始化菜单数据：

1. **直接执行SQL语句**（推荐方式）
2. **运行Go程序初始化**

## 🚀 方式一：直接执行SQL语句（推荐）

### 1. 执行SQL脚本

打开您的数据库管理工具（MySQL Workbench、phpMyAdmin、Navicat等），执行以下文件：

```
database_menu_insert.sql
```

### 2. 验证插入结果

执行以下查询语句验证菜单数据是否正确插入：

```sql
SELECT 
    id, 
    name, 
    parent_id, 
    type, 
    sort, 
    status,
    visible
FROM system_menu 
ORDER BY parent_id, sort;
```

### 3. 预期结果

应该看到类似以下的数据结构：

| 菜单名称 | 菜单类型 | 父级菜单 | 显示顺序 |
|---------|---------|---------|---------|
| 首页 | 目录(1) | 无 | 1 |
| 系统管理 | 目录(1) | 无 | 2 |
| 用户管理 | 菜单(2) | 系统管理 | 1 |
| 部门管理 | 菜单(2) | 系统管理 | 2 |
| 角色管理 | 菜单(2) | 系统管理 | 3 |
| 菜单管理 | 菜单(2) | 系统管理 | 4 |
| 字典管理 | 目录(1) | 无 | 3 |
| 字典类型 | 菜单(2) | 字典管理 | 1 |
| 字典数据 | 菜单(2) | 字典管理 | 2 |
| 监控运维 | 目录(1) | 无 | 4 |
| 主机管理 | 菜单(2) | 监控运维 | 1 |
| AI助手 | 菜单(2) | 监控运维 | 2 |

## 🛠️ 方式二：运行Go程序初始化

### 1. 进入后端目录

```bash
cd backend/k8s-platform-go
```

### 2. 确保数据库配置正确

检查 `configs/config.yaml` 文件中的数据库配置：

```yaml
mysql:
  host: localhost
  port: 3306
  username: your_username
  password: your_password
  database: your_database
```

### 3. 编译并运行初始化程序

```bash
go run cmd/menu_seed.go
```

### 4. 查看运行结果

程序会输出类似以下信息：

```
成功插入 15 条菜单数据
菜单数据初始化成功！
```

## 📊 菜单数据结构说明

### 菜单类型说明
- **1**: 目录（一级菜单）
- **2**: 菜单（二级菜单）
- **3**: 按钮（权限按钮）

### 状态说明
- **0**: 正常
- **1**: 停用

### 重要字段说明

| 字段名 | 说明 | 示例 |
|--------|------|------|
| name | 菜单名称 | "用户管理" |
| permission | 权限标识 | "system:user:list" |
| type | 菜单类型 | 1/2/3 |
| sort | 显示顺序 | 数字，数值越小越靠前 |
| parent_id | 父菜单ID | 0表示一级菜单 |
| path | 路由地址 | "/user" |
| icon | 菜单图标 | "User" |
| component | 组件路径 | "user/index" |
| visible | 是否可见 | true/false |
| keep_alive | 是否缓存 | true/false |
| always_show | 是否总是显示 | true/false |

## ⚠️ 注意事项

### 1. 数据库兼容性
- 该SQL语句适用于 MySQL 5.7+、PostgreSQL、SQLite
- 如果使用其他数据库，请相应调整时间函数

### 2. 表结构要求
确保您的 `system_menu` 表包含以下字段：
- id (主键)
- name (菜单名称)
- permission (权限标识)
- type (菜单类型)
- sort (显示顺序)
- parent_id (父菜单ID)
- path (路由地址)
- icon (图标)
- component (组件路径)
- component_name (组件名称)
- status (状态)
- visible (是否可见)
- keep_alive (是否缓存)
- always_show (是否总是显示)
- creator (创建人)
- create_at (创建时间)
- updater (更新人)
- update_at (更新时间)

### 3. 字段名映射
如果您的数据库字段名是 snake_case 格式，需要相应调整SQL语句中的字段名。

### 4. 权限标识规范
权限标识建议使用 `模块:操作:资源` 的格式：
- `system:user:list` - 系统-用户-查看
- `system:user:add` - 系统-用户-新增
- `system:user:edit` - 系统-用户-编辑
- `system:user:delete` - 系统-用户-删除

## 🔧 故障排除

### 1. 插入失败
- 检查数据库连接是否正常
- 确认表结构是否正确
- 验证权限是否足够

### 2. 菜单不显示
- 检查菜单状态是否为0（正常）
- 检查 visible 字段是否为1（可见）
- 确认路由是否正确配置

### 3. 层级关系错误
- 验证 parent_id 是否正确设置
- 检查是否存在循环依赖

## 📞 技术支持

如果遇到问题，请检查：
1. 数据库连接配置
2. 表结构定义
3. 权限设置
4. 控制台错误日志

完成菜单数据初始化后，您就可以在前端正常使用菜单管理功能了！